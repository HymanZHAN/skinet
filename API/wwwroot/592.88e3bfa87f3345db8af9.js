(self.webpackChunkclient=self.webpackChunkclient||[]).push([[592],{3623:(e,t,r)=>{"use strict";r.d(t,{c:()=>y,t:()=>b});var i=r(8619),s=r(5959),o=r(5416);const n=i.GuJ,d=Symbol("__destroy"),h=Symbol("__decoratorApplied");function a(e){return"string"==typeof e?Symbol(`__destroy__${e}`):d}function p(e,t){e[t]||(e[t]=new s.xQ)}function c(e,t){e[t]&&(e[t].next(),e[t].complete(),e[t]=null)}function l(e){e&&"function"==typeof e.unsubscribe&&e.unsubscribe()}function u(e,t){return function(){var r,i;if(e&&e.call(this),c(this,a()),t.arrayName)return i=this[t.arrayName],void(Array.isArray(i)&&i.forEach(l));if(t.checkProperties)for(const e in this)(null===(r=t.blackList)||void 0===r?void 0:r.includes(e))||l(this[e])}}function y(e={}){return t=>{t[n]?function(e,t){const r=e.\u0275pipe;r.onDestroy=u(r.onDestroy,t)}(t,e):function(e,t){e.prototype.ngOnDestroy=u(e.prototype.ngOnDestroy,t)}(t,e),function(e){e.prototype[h]=!0}(t)}}function b(e,t){return r=>{const i=a(t);return"string"==typeof t?function(e,t,r){const i=e[t];p(e,r),e[t]=function(){i.apply(this,arguments),c(this,r),e[t]=i}}(e,t,i):p(e,i),r.pipe((0,o.R)(e[i]))}}},8298:(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var i=r(529);const s={id:0,shortName:"",deliveryTime:"",description:"",price:0};var o=r(9996),n=r(8512),d=r(1305);const h={firstName:"",lastName:"",street:"",city:"",state:"",zipCode:""};var a=r(8619),p=r(2693),c=r(3241);let l=(()=>{class e{constructor(e,t){this.http=e,this.basketService=t,this.baseUrl=i.N.apiUrl,this.deliveryMethods=new n.X([]),this.deliveryMethods$=this.deliveryMethods.asObservable(),this.deliveryMethod=new n.X(s),this.deliveryMethod$=this.deliveryMethod.asObservable(),this.shippingAddress=new n.X(h),this.shippingAddress$=this.shippingAddress.asObservable(),this.basket$=this.basketService.basket$,this.orderSubtotal$=this.basket$.pipe((0,o.U)(e=>this.calculateOrderSubtotal(e))),this.orderShippingFee$=this.deliveryMethod$.pipe((0,o.U)(e=>e.price)),this.orderTotal$=(0,d.aj)([this.orderSubtotal$,this.orderShippingFee$]).pipe((0,o.U)(e=>e[0]+e[1])),this.orderSummary$=(0,d.aj)([this.orderSubtotal$,this.orderShippingFee$,this.orderTotal$]).pipe((0,o.U)(e=>({orderSubtotal:e[0],orderShippingFee:e[1],orderTotal:e[2]})))}getDeliveryMethods(){return this.http.get(`${this.baseUrl}/orders/deliveryMethods`).pipe((0,o.U)(e=>e.sort((e,t)=>t.price-e.price)),(0,o.U)(e=>this.deliveryMethods.next(e)))}setShippingMethod(e){let t=this.deliveryMethods.value.find(t=>t.id.toString()===e);t=t||s,this.deliveryMethod.next(t);const r=this.basketService.currentBasket;r.deliveryMethodId=t.id,this.basketService.setBasket(r)}clearShippingMethod(){this.deliveryMethod.next(s)}setShippingAddress(e){this.shippingAddress.next(e)}generateOrderToCreate(){let e;return(0,d.aj)([this.basket$,this.deliveryMethod$,this.shippingAddress$]).pipe((0,o.U)(e=>({basketId:e[0].id,deliveryMethodId:e[1].id,shipToAddress:e[2]}))).subscribe(t=>{e=t}).unsubscribe(),e}createOrder(){const e=this.generateOrderToCreate();return this.http.post(`${this.baseUrl}/orders`,e)}calculateOrderSubtotal(e){return 0===e.items.length?0:e.items.map(e=>e.quantity*e.price).reduce((e,t)=>e+t)}createPaymentIntent(){return this.basketService.createPaymentIntent()}}return e.\u0275fac=function(t){return new(t||e)(a.LFG(p.eN),a.LFG(c.v))},e.\u0275prov=a.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);
//# sourceMappingURL=592.88e3bfa87f3345db8af9.js.map